# ДЗ #2 Express.js

Приклад розробки сервера з використанням Express.js, демонструє інтеграцію та використання різних типів middleware (мідлварів) для логування, аутентифікації, авторизації, валідації даних та обробки помилок.
Архітектура проєкту відповідає патерну MVC (Model-View-Controller).

## 1. Технології:

- Node.js
- Express.js
- Celebrate
- Joi

## 2. Використані Middleware

### 2.1. logRequests (src/middleware/logging.mjs)

Записує інформацію про кожен вхідний HTTP-запит (час, метод, URL) у консоль сервера. Допомагає у моніторингу та дебагінгу. Використовується глобально до всіх запитів (app.use(logRequests))

### 2.2. basicAuth (src/middleware/auth.mjs)

Виконує базову аутентифікацію, перевіряючи наявність та значення токена авторизації в заголовку Authorization: Bearer <token>. Якщо токен відсутній або невірний, повертає 401 Unauthorized. Використовується до маршрутів, пов'язаних з користувачами (/users, /users/:userId).

### 2.3 checkArticleAccess (src/middleware/auth.mjs)

Виконує авторизацію, перевіряючи права доступу користувача на основі його ролі. Якщо роль відсутня або не дозволена, повертає 403 Forbidden. Використовується до маршрутів, пов'язаних зі статтями (/articles, /articles/:articleId).

### 2.4 Валідатори (validateUserBody, validateParamsUserId, validateArticleBody, validateParamsArticleId) (src/middleware/validation.mjs)

Виконують валідацію вхідних даних (тіла запиту або параметрів URL) за допомогою бібліотек Joi (для визначення схеми валідації) та celebrate. Якщо дані не проходять валідацію, повертає 400 Bad Request з текстовим описом помилки.

### 2.5 Обробники помилок (notFoundHandler, errorHandler) (src/middleware/errorHandling.mjs)

- notFoundHandler: Обробляє запити до неіснуючих маршрутів, повертаючи 404 Not Found.
- errorHandler: Глобальний обробник помилок, який перехоплює всі необроблені помилки в додатку. Він спеціально обробляє помилки celebrate, повертаючи 400 Bad Request з повідомленням про валідацію. Для інших помилок повертає 500 Internal Server Error.

Застосовуються глобаль в server.mjs.

## 3. Реалізовані маршрути

Маршрути реалізовані за домопогоду Express Router

### 3.1 Кореневий маршрут ('/')

Базовий маршрут для перевірки доступності сервера (дозволяє метод GET).

### 3.2 Користувачі ('/users')

Дозволено:

- отримати список користувачів (GET)
- додати нового користувача (POST)
- отримати інфо користувача за ID ('/users/:userId' - GET)
- оновити користувача за ID ('/users/:userId' - PUT)
- видалити користувача за ID ('/users/:userId' - DELETE)

### 3.2 Статті ('/articles')

- отримати всі статті (GET)
- додати нову статтю (POST)
- отримати статтю за ID ('/articles/:articleId' - GET)
- оновити статтю за ID ('/articles/:articleId' - PUT)
- видалити статтю за ID ('/articles/:articleId' - DELETE)

## 4. Налаштування репозиторію і запуск сервера:

### 4.1. Завантажуємо репозиторій та розгортаємо проект

`npm install`

або

`yarn`

_yarn повинен бути встановлений глобально, це можна зробити командой:_

`npm i -g yarn`

### 4.2. Запускаємо сервер

`npm start

# або

node src/server.mjs`

### 4.3. Перевіряємо роботу сервера

Сервер буде запущено на порту 3000. Ви побачите повідомлення у консолі: Сервер запущений за адресою http://localhost:3000.

### 4.4. Припинення роботи сервера

Необхідно повернутися до терміналу і натиснути комбінацію клавіш Ctrl + C
